/**
 * in-article-ad-tool
 * Generated: 2018-01-09
 * Version: 0.2.0
 */

!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.inArticleAdTool=r()}(this,function(){"use strict";var e=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};function r(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}var t=3,n=3,o="p",i=0;return{init:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=c.containerSelector,l=c.limit,f=void 0===l?i:l,d=r(c,["containerSelector","limit"]);!function(e){var r=e.containerSelector,c=e.elementSelector,a=void 0===c?o:c,l=e.adCode,f=e.firstAppearance,d=void 0===f?t:f,u=e.insertEvery,s=void 0===u?n:u,m=e.limit,v=void 0===m?i:m;if("string"!=typeof r)throw new Error("containerSelector should be a String");if("string"!=typeof a)throw new Error("elementSelector should be a String");if("string"!=typeof l&&"function"!=typeof l)throw new Error("adCode should be a String or function");if("number"!=typeof d)throw new Error("firstAppearance should be a Number");if(d<=0)throw new Error("firstAppearance should be > 0");if("number"!=typeof s)throw new Error("insertEvery should be a Number");if(s<0)throw new Error("insertEvery should be >= 0");if("number"!=typeof v)throw new Error("limit should be a Number");if(v<0)throw new Error("limit should be >= 0")}(e({containerSelector:a,limit:f},d));var u=0,s=f>0;document.querySelectorAll(a).forEach(function(o,c){(!s||u<f)&&(u+=function(o){var c=o.element,a=o.index,l=o.elementSelector,f=r(o,["element","index","elementSelector"]);c.setAttribute("data-in-article-container",a);var d,u=(d=c.querySelectorAll('[data-in-article-container="'+a+'"] > '+l),Array.from(d.values()));return u.filter(function(r,n){return function(e){e.element;var r=e.index,n=e.firstAppearance,o=void 0===n?t:n;return r+1>=o}(e({element:r,index:n},f))}).filter(function(r,t){return function(e){var r=e.index,t=e.insertEvery,o=void 0===t?n:t;return 0===r||o>0&&r%o==0}(e({index:t},f))}).filter(function(r,t){return function(e){var r=e.index,t=e.limit,n=void 0===t?i:t;return 0===n||n>0&&r<n}(e({index:t},f))}).forEach(function(r,t){!function(e){var r=e.element,t=e.index,n=e.adCode,o=document.createElement("div");"function"==typeof n&&(n=n(r,t)),o.innerHTML=n,o.childNodes.forEach(function(e,t){var n=e.cloneNode(!0);if("SCRIPT"===n.nodeName){var o=n;n=document.createElement("script"),o.src&&(n.src=o.src,n.setAttribute("async",""));var i=document.createTextNode(o.text);n.appendChild(i)}a=n,(c=r).parentNode.insertBefore(a,c);var c,a})}(e({element:r,index:t},f))}),u.length}(e({element:o,index:c,limit:f},d)),s&&(d.limit-=u))})}}});
